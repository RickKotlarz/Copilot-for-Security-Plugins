# Author Rick Kotlarz ~ https://github.com/RickKotlarz/
# 2024-Dec-26

openapi: 3.0.0

info:
  title: Palo Alto XSOAR
  description: Plugin example leveraging the Palo Alto XSOAR API
  version: "v2.0.6"

servers:
  - url:  https://httpbin.org/
#  - url: https://api-yourfqdn/xsoar/
#   Replace the above URL with your Palo Alto XSOAR URL.
# https://learn.openapis.org/specification/security.html
    
paths:
####################################################################################
#  Dashboards
#     Get all dashboards details
#     https://cortex-panw.stoplight.io/docs/cortex-xsoar-8/
####################################################################################
#  /public/v1/dashboards:
  /headers:
    get:
      operationId: X-GetAllDashboardDetails
      description: |
        Palo Alto XSOAR - Get all dashboards details
      examplePrompts:
        - 'Get all Palo Alto XSOAR dashboards'
        - 'Get all Palo Alto XSOAR dashboards details'
        - 'Get all details for Palo Alto XSOAR dashboards'
      parameters:
        - $ref: '#/components/parameters/x-xdr-auth-id'
      responses:
        "200":
          description: OK
        "400":
          description: Bad request, invalid parameters
          
####################################################################################
#  Dashboards
#     Get dashboard details for the specified dashboard
####################################################################################
  /public/v1/dashboards/{dashboardId}:
    get:
      operationId: X-GetDashboardDetails
      description: |
        Palo Alto XSOAR - Get details for specefic dashboard
      examplePrompts:
        - 'Get all Palo Alto XSOAR dashboards'
        - 'Get details for Palo Alto XSOAR dashboard'
      parameters:
        - $ref: '#/components/parameters/x-xdr-auth-id'
        - in: path
          name: dashboardId
          schema:
            type: string
          required: true
          placeholderValue: Dashboard to look up
          description: Dashboard to look up
      responses:
        "200":
          description: OK
        "400":
          description: Bad request, invalid parameters
          
####################################################################################
#  Incidents
#     Get a specefic incident
####################################################################################

  /public/v1/incident/load/{id}:
    get:
      operationId: X-GetIncident
      description: |
        Palo Alto XSOAR - Get a specific incident
      examplePrompts:
        - 'Get Palo Alto XSOAR incident'
        - 'Get Palo incident'
        - 'Get Palo XSOAR incident'
      parameters:
        - $ref: '#/components/parameters/x-xdr-auth-id'
        - in: path
          name: id
          schema:
            type: string
          required: true
          placeholderValue: Incident ID to look up (e.g. 1234)
          description: Incident ID to look up
      responses:
        "200":
          description: OK
        "400":
          description: Bad request, invalid parameters

####################################################################################
components:
  parameters:
    x-xdr-auth-id:
      name: x-xdr-auth-id
      in: header
      required: false
      description: "My API auth ID"
      schema:
        type: string
        default: 1234          # API authentication ID to be passed during each request. DO NOT encapsulate the value in quotes.
#        default: {{settingTestName}}
  securitySchemes:
    apiKeyIDAuth:              # Arbitrary name for the security scheme
      type: apiKey
      in: header               # Can be "header", "query" or "cookie"
      name: x-xdr-auth-id      # Value sent to the endpoint in the requested (e.g. {x-xdr-auth-id: 24})
      description: "The API Key ID for authentication."
    apiKeySecretAuth:
      type: apiKey
      in: header
      name: Authorization
      description: "The API Key Secret for authentication."
  security:
    - apiKeyIDAuth: []
      apiKeySecretAuth: []   # <-- No leading dash (-) as this indicates both must be present and NOT either or.
